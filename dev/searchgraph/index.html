<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>SearchGraph · SimilaritySearch.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://sadit.github.io/SimilaritySearch.jl/searchgraph/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SimilaritySearch.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../searching/">Searching</a></li><li class="is-active"><a class="tocitem" href>SearchGraph</a><ul class="internal"><li><a class="tocitem" href="#Local-search-algorithms"><span>Local search algorithms</span></a></li><li><a class="tocitem" href="#Neighborhood-algorithms"><span>Neighborhood algorithms</span></a></li><li><a class="tocitem" href="#Incremental-construction-of-the-index"><span>Incremental construction of the index</span></a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../knnresult/">Knn results</a></li><li><a class="tocitem" href="../distminkowski/">Minkowski distances</a></li><li><a class="tocitem" href="../distcos/">Cosine and angle distances</a></li><li><a class="tocitem" href="../diststrings/">String alignments</a></li><li><a class="tocitem" href="../disthamming/">Hamming distances</a></li><li><a class="tocitem" href="../distsets/">Sets distances</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>SearchGraph</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>SearchGraph</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sadit/SimilaritySearch.jl/blob/master/docs/src/searchgraph.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><p><code>SearchGraph</code> creates a graph</p><p><em>Tellez, E. S., Ruiz, G., Chavez, E., &amp; Graff, M.A scalable solution to the nearest neighbor search problem through local-search methods on neighbor graphs. Pattern Analysis and Applications, 1-15.</em></p><p>As before, we need a dataset <span>$X$</span> and a distance function.</p><pre><code class="language-julia">using SimilaritySearch
X = [randn(3) for i in 1:10_000]
Q = [randn(3) for i in 1:5]


index = SearchGraph(; dist=L2Distance(), verbose=true)
append!(index, X)

for q in Q
    println(search(index, q, KnnResult(3)))
end</code></pre><pre class="documenter-example-output">calling callback optimize_hints; n=15
calling callback optimize_parameters; n=15
==== BEGIN Opt. {BeamSearch: bsize=8, hints=6, expected recall: 0.9, n: 15
  == Begin Opt. {BeamSearch: bsize=8, hints=6 iteration: 1, expected recall: 0.9, n: 15
    ** new best conf: (state={BeamSearch: bsize=9, hints=0, score=2.026315789473684, perf=StatsComparison(1.0, 1.0, 1.0, 2.1641071026141826e-6, 14.615384615384615, StatsKnn(19.492548062251164, 1.0716500007189238, 2.7465748511827908, 10.0), 1.0086939885066106e-6, StatsKnn(19.492548062251164, 1.0716500007189238, 2.7465748511827908, 10.0))  ), #beam: 2, n: 15
    ** new best conf: (state={BeamSearch: bsize=13, hints=0, score=2.089385474860335, perf=StatsComparison(0.944055944055944, 0.9496503496503497, 0.9467199467199467, 2.6226043701171875e-6, 13.76923076923077, StatsKnn(19.625336940471943, 1.0716500007189238, 2.839082360267639, 9.923076923076923), 1.0086939885066106e-6, StatsKnn(19.492548062251164, 1.0716500007189238, 2.7465748511827908, 10.0))  ), #beam: 3, n: 15
    ** new best conf: (state={BeamSearch: bsize=17, hints=0, score=2.0540540540540544, perf=StatsComparison(0.979020979020979, 0.979020979020979, 0.979020979020979, 2.6042644794170674e-6, 14.23076923076923, StatsKnn(19.600750336280235, 1.0716500007189238, 2.7964179607538076, 10.0), 1.0086939885066106e-6, StatsKnn(19.492548062251164, 1.0716500007189238, 2.7465748511827908, 10.0))  ), #beam: 4, n: 15
  == Iteration finished, current best: (state={BeamSearch: bsize=13, hints=0, score=2.089385474860335, perf=StatsComparison(0.944055944055944, 0.9496503496503497, 0.9467199467199467, 2.6226043701171875e-6, 13.76923076923077, StatsKnn(19.625336940471943, 1.0716500007189238, 2.839082360267639, 9.923076923076923), 1.0086939885066106e-6, StatsKnn(19.492548062251164, 1.0716500007189238, 2.7465748511827908, 10.0))  ), #beam: 4, n: 15
  == Begin Opt. {BeamSearch: bsize=14, hints=0 iteration: 2, expected recall: 0.9, n: 15
  == Iteration finished, current best: (state={BeamSearch: bsize=13, hints=0, score=2.089385474860335, perf=StatsComparison(0.944055944055944, 0.9496503496503497, 0.9467199467199467, 2.6226043701171875e-6, 13.76923076923077, StatsKnn(19.625336940471943, 1.0716500007189238, 2.839082360267639, 9.923076923076923), 1.0086939885066106e-6, StatsKnn(19.492548062251164, 1.0716500007189238, 2.7465748511827908, 10.0))  ), #beam: 4, n: 15
==== END Opt. Finished, best: (state={BeamSearch: bsize=13, hints=0, score=2.089385474860335, perf=StatsComparison(0.944055944055944, 0.9496503496503497, 0.9467199467199467, 2.6226043701171875e-6, 13.76923076923077, StatsKnn(19.625336940471943, 1.0716500007189238, 2.839082360267639, 9.923076923076923), 1.0086939885066106e-6, StatsKnn(19.492548062251164, 1.0716500007189238, 2.7465748511827908, 10.0))  ), n: 15
calling callback optimize_hints; n=31
calling callback optimize_parameters; n=31
==== BEGIN Opt. {BeamSearch: bsize=13, hints=8, expected recall: 0.9, n: 31
  == Begin Opt. {BeamSearch: bsize=13, hints=8 iteration: 1, expected recall: 0.9, n: 31
    ** new best conf: (state={BeamSearch: bsize=11, hints=0, score=2.1193092621664054, perf=StatsComparison(1.0, 1.0, 1.0, 4.395194675611413e-6, 27.695652173913043, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 3, n: 31
    ** new best conf: (state={BeamSearch: bsize=6, hints=0, score=2.1765676567656764, perf=StatsComparison(1.0, 1.0, 1.0, 4.177508146866508e-6, 26.347826086956523, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 4, n: 31
  == Iteration finished, current best: (state={BeamSearch: bsize=6, hints=0, score=2.1765676567656764, perf=StatsComparison(1.0, 1.0, 1.0, 4.177508146866508e-6, 26.347826086956523, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 4, n: 31
  == Begin Opt. {BeamSearch: bsize=9, hints=0 iteration: 2, expected recall: 0.9, n: 31
    ** new best conf: (state={BeamSearch: bsize=4, hints=0, score=2.2619469026548673, perf=StatsComparison(0.9960474308300394, 0.9960474308300394, 0.9960474308300394, 3.3482261326002036e-6, 24.565217391304348, StatsKnn(12.752549669016963, 0.6635502524997877, 1.7087489107380742, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 5, n: 31
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=2.3817829457364343, perf=StatsComparison(0.992094861660079, 0.992094861660079, 0.992094861660079, 2.912853075110394e-6, 22.434782608695652, StatsKnn(12.779051905092986, 0.6635502524997877, 1.7048270754192187, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 7, n: 31
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=2.31549815498155, perf=StatsComparison(0.9723320158102765, 0.9723320158102765, 0.9723320158102765, 3.0476114024286685e-6, 23.565217391304348, StatsKnn(12.80672666300898, 0.6635502524997877, 1.7158007258954255, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 8, n: 31
  == Iteration finished, current best: (state={BeamSearch: bsize=2, hints=0, score=2.3817829457364343, perf=StatsComparison(0.992094861660079, 0.992094861660079, 0.992094861660079, 2.912853075110394e-6, 22.434782608695652, StatsKnn(12.779051905092986, 0.6635502524997877, 1.7048270754192187, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 4, n: 31
  == Begin Opt. {BeamSearch: bsize=13, hints=0 iteration: 3, expected recall: 0.9, n: 31
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=2.4118811881188122, perf=StatsComparison(0.9881422924901185, 0.9881422924901185, 0.9881422924901185, 2.8299248736837637e-6, 21.956521739130434, StatsKnn(12.763230033542799, 0.6635502524997877, 1.7120206252388332, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 5, n: 31
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=2.3980392156862744, perf=StatsComparison(0.9881422924901185, 0.9881422924901185, 0.9881422924901185, 2.560408219047215e-6, 22.17391304347826, StatsKnn(12.761475024016008, 0.6635502524997877, 1.7132475583449653, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 9, n: 31
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=2.409090909090909, perf=StatsComparison(0.9644268774703556, 0.9644268774703556, 0.9644268774703556, 2.384185791015625e-6, 22.0, StatsKnn(12.852527079374894, 0.6635502524997877, 1.7369082544160925, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 10, n: 31
  == Iteration finished, current best: (state={BeamSearch: bsize=2, hints=0, score=2.4118811881188122, perf=StatsComparison(0.9881422924901185, 0.9881422924901185, 0.9881422924901185, 2.8299248736837637e-6, 21.956521739130434, StatsKnn(12.763230033542799, 0.6635502524997877, 1.7120206252388332, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), #beam: 4, n: 31
==== END Opt. Finished, best: (state={BeamSearch: bsize=2, hints=0, score=2.4118811881188122, perf=StatsComparison(0.9881422924901185, 0.9881422924901185, 0.9881422924901185, 2.8299248736837637e-6, 21.956521739130434, StatsKnn(12.763230033542799, 0.6635502524997877, 1.7120206252388332, 10.0), 1.482341600501019e-6, StatsKnn(12.742819578751273, 0.6635502524997877, 1.7002965471018916, 10.0))  ), n: 31
calling callback optimize_hints; n=63
calling callback optimize_parameters; n=63
==== BEGIN Opt. {BeamSearch: bsize=2, hints=10, expected recall: 0.9, n: 63
  == Begin Opt. {BeamSearch: bsize=2, hints=10 iteration: 1, expected recall: 0.9, n: 63
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=2.96875, perf=StatsComparison(0.9669421487603306, 0.9669421487603306, 0.9669421487603306, 3.543767062100497e-6, 32.0, StatsKnn(10.25633226741444, 0.5387851396067576, 1.352897817438299, 10.0), 1.9073486328125e-6, StatsKnn(10.198614098808982, 0.5387851396067576, 1.3281498822298916, 10.0))  ), #beam: 2, n: 63
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=3.138888888888889, perf=StatsComparison(0.9462809917355371, 0.9462809917355371, 0.9462809917355371, 3.131953152743253e-6, 29.454545454545453, StatsKnn(10.370810161937367, 0.5387851396067576, 1.3903581554239446, 10.0), 1.9073486328125e-6, StatsKnn(10.198614098808982, 0.5387851396067576, 1.3281498822298916, 10.0))  ), #beam: 3, n: 63
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=3.0028901734104045, perf=StatsComparison(0.9628099173553721, 0.9628099173553721, 0.9628099173553721, 3.4570693969726562e-6, 31.454545454545453, StatsKnn(10.284456708214499, 0.5387851396067576, 1.3664797977967695, 10.0), 1.9073486328125e-6, StatsKnn(10.198614098808982, 0.5387851396067576, 1.3281498822298916, 10.0))  ), #beam: 4, n: 63
  == Iteration finished, current best: (state={BeamSearch: bsize=2, hints=0, score=3.138888888888889, perf=StatsComparison(0.9462809917355371, 0.9462809917355371, 0.9462809917355371, 3.131953152743253e-6, 29.454545454545453, StatsKnn(10.370810161937367, 0.5387851396067576, 1.3903581554239446, 10.0), 1.9073486328125e-6, StatsKnn(10.198614098808982, 0.5387851396067576, 1.3281498822298916, 10.0))  ), #beam: 4, n: 63
  == Begin Opt. {BeamSearch: bsize=7, hints=0 iteration: 2, expected recall: 0.9, n: 63
  == Iteration finished, current best: (state={BeamSearch: bsize=2, hints=0, score=3.138888888888889, perf=StatsComparison(0.9462809917355371, 0.9462809917355371, 0.9462809917355371, 3.131953152743253e-6, 29.454545454545453, StatsKnn(10.370810161937367, 0.5387851396067576, 1.3903581554239446, 10.0), 1.9073486328125e-6, StatsKnn(10.198614098808982, 0.5387851396067576, 1.3281498822298916, 10.0))  ), #beam: 4, n: 63
==== END Opt. Finished, best: (state={BeamSearch: bsize=2, hints=0, score=3.138888888888889, perf=StatsComparison(0.9462809917355371, 0.9462809917355371, 0.9462809917355371, 3.131953152743253e-6, 29.454545454545453, StatsKnn(10.370810161937367, 0.5387851396067576, 1.3903581554239446, 10.0), 1.9073486328125e-6, StatsKnn(10.198614098808982, 0.5387851396067576, 1.3281498822298916, 10.0))  ), n: 63
calling callback optimize_hints; n=127
calling callback optimize_parameters; n=127
==== BEGIN Opt. {BeamSearch: bsize=2, hints=12, expected recall: 0.9, n: 127
  == Begin Opt. {BeamSearch: bsize=2, hints=12 iteration: 1, expected recall: 0.9, n: 127
  == Iteration finished, current best: (state={BeamSearch: bsize=2, hints=0, score=4.231856738925542, perf=StatsComparison(0.9696969696969696, 0.9696969696969696, 0.9696969696969696, 3.7705456769024884e-6, 39.2962962962963, StatsKnn(8.914100523348209, 0.4990533593076247, 1.1593603513858937, 10.0), 2.887513902452257e-6, StatsKnn(8.873191709871646, 0.4990533593076247, 1.1478319388848763, 10.0))  ), #beam: 4, n: 127
==== END Opt. Finished, best: (state={BeamSearch: bsize=2, hints=0, score=4.231856738925542, perf=StatsComparison(0.9696969696969696, 0.9696969696969696, 0.9696969696969696, 3.7705456769024884e-6, 39.2962962962963, StatsKnn(8.914100523348209, 0.4990533593076247, 1.1593603513858937, 10.0), 2.887513902452257e-6, StatsKnn(8.873191709871646, 0.4990533593076247, 1.1478319388848763, 10.0))  ), n: 127
calling callback optimize_hints; n=255
calling callback optimize_parameters; n=255
==== BEGIN Opt. {BeamSearch: bsize=2, hints=13, expected recall: 0.9, n: 255
  == Begin Opt. {BeamSearch: bsize=2, hints=13 iteration: 1, expected recall: 0.9, n: 255
  == Iteration finished, current best: (state={BeamSearch: bsize=10, hints=0, score=5.981096408317581, perf=StatsComparison(0.9736070381231671, 0.9736070381231671, 0.9736070381231671, 5.445172709803428e-6, 51.193548387096776, StatsKnn(6.144473883413499, 0.3335683422703897, 0.787967509800388, 10.0), 4.353061799080141e-6, StatsKnn(6.124145438594203, 0.3335683422703897, 0.7794910121348596, 10.0))  ), #beam: 4, n: 255
==== END Opt. Finished, best: (state={BeamSearch: bsize=10, hints=0, score=5.981096408317581, perf=StatsComparison(0.9736070381231671, 0.9736070381231671, 0.9736070381231671, 5.445172709803428e-6, 51.193548387096776, StatsKnn(6.144473883413499, 0.3335683422703897, 0.787967509800388, 10.0), 4.353061799080141e-6, StatsKnn(6.124145438594203, 0.3335683422703897, 0.7794910121348596, 10.0))  ), n: 255
calling callback optimize_hints; n=511
calling callback optimize_parameters; n=511
==== BEGIN Opt. {BeamSearch: bsize=10, hints=16, expected recall: 0.9, n: 511
  == Begin Opt. {BeamSearch: bsize=10, hints=16 iteration: 1, expected recall: 0.9, n: 511
    ** new best conf: (state={BeamSearch: bsize=5, hints=0, score=8.490609253321118, perf=StatsComparison(1.0, 1.0, 1.0, 7.68899917602539e-6, 68.21875, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 3, n: 511
    ** new best conf: (state={BeamSearch: bsize=5, hints=0, score=8.480329368709972, perf=StatsComparison(1.0, 1.0, 1.0, 7.309019565582275e-6, 68.3125, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 4, n: 511
    ** new best conf: (state={BeamSearch: bsize=4, hints=0, score=8.884281581485052, perf=StatsComparison(0.9943181818181818, 0.9943181818181818, 0.9943181818181818, 6.191432476043701e-6, 64.8125, StatsKnn(6.099544197320938, 0.3432123304810375, 0.7710073888301849, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 5, n: 511
  == Iteration finished, current best: (state={BeamSearch: bsize=4, hints=0, score=8.884281581485052, perf=StatsComparison(0.9943181818181818, 0.9943181818181818, 0.9943181818181818, 6.191432476043701e-6, 64.8125, StatsKnn(6.099544197320938, 0.3432123304810375, 0.7710073888301849, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 4, n: 511
  == Begin Opt. {BeamSearch: bsize=17, hints=0 iteration: 2, expected recall: 0.9, n: 511
    ** new best conf: (state={BeamSearch: bsize=3, hints=0, score=8.949440933398153, perf=StatsComparison(0.9914772727272728, 0.9914772727272728, 0.9914772727272728, 6.623566150665283e-6, 64.28125, StatsKnn(6.099450007081032, 0.3432123304810375, 0.7717570532113314, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 8, n: 511
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=8.95330739299611, perf=StatsComparison(0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 5.535781383514404e-6, 64.25, StatsKnn(6.101091586053371, 0.3432123304810375, 0.7728991974145174, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 10, n: 511
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=9.131277971158628, perf=StatsComparison(0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 6.370246410369873e-6, 62.84375, StatsKnn(6.100984498858452, 0.3432123304810375, 0.772439805790782, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 21, n: 511
  == Iteration finished, current best: (state={BeamSearch: bsize=2, hints=0, score=9.131277971158628, perf=StatsComparison(0.9886363636363636, 0.9886363636363636, 0.9886363636363636, 6.370246410369873e-6, 62.84375, StatsKnn(6.100984498858452, 0.3432123304810375, 0.772439805790782, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 4, n: 511
  == Begin Opt. {BeamSearch: bsize=13, hints=0 iteration: 3, expected recall: 0.9, n: 511
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=9.159680638722556, perf=StatsComparison(0.9829545454545455, 0.9829545454545455, 0.9829545454545455, 6.310641765594482e-6, 62.625, StatsKnn(6.107482016086578, 0.3432123304810375, 0.773013036698103, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 5, n: 511
  == Iteration finished, current best: (state={BeamSearch: bsize=2, hints=0, score=9.159680638722556, perf=StatsComparison(0.9829545454545455, 0.9829545454545455, 0.9829545454545455, 6.310641765594482e-6, 62.625, StatsKnn(6.107482016086578, 0.3432123304810375, 0.773013036698103, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), #beam: 4, n: 511
==== END Opt. Finished, best: (state={BeamSearch: bsize=2, hints=0, score=9.159680638722556, perf=StatsComparison(0.9829545454545455, 0.9829545454545455, 0.9829545454545455, 6.310641765594482e-6, 62.625, StatsKnn(6.107482016086578, 0.3432123304810375, 0.773013036698103, 10.0), 6.966292858123779e-6, StatsKnn(6.093612626194954, 0.3432123304810375, 0.7699197512120008, 10.0))  ), n: 511
calling callback optimize_hints; n=1023
calling callback optimize_parameters; n=1023
==== BEGIN Opt. {BeamSearch: bsize=2, hints=18, expected recall: 0.9, n: 1023
  == Begin Opt. {BeamSearch: bsize=2, hints=18 iteration: 1, expected recall: 0.9, n: 1023
  == Iteration finished, current best: (state={BeamSearch: bsize=10, hints=0, score=16.180947821924363, perf=StatsComparison(0.9824046920821116, 0.9824046920821116, 0.9824046920821116, 6.321937807144657e-6, 67.38709677419355, StatsKnn(4.726883826717254, 0.266318135804707, 0.6047846299986686, 10.0), 1.1321037046370968e-5, StatsKnn(4.716615353861163, 0.266318135804707, 0.6015012898752766, 10.0))  ), #beam: 4, n: 1023
==== END Opt. Finished, best: (state={BeamSearch: bsize=10, hints=0, score=16.180947821924363, perf=StatsComparison(0.9824046920821116, 0.9824046920821116, 0.9824046920821116, 6.321937807144657e-6, 67.38709677419355, StatsKnn(4.726883826717254, 0.266318135804707, 0.6047846299986686, 10.0), 1.1321037046370968e-5, StatsKnn(4.716615353861163, 0.266318135804707, 0.6015012898752766, 10.0))  ), n: 1023
calling callback optimize_hints; n=2047
calling callback optimize_parameters; n=2047
==== BEGIN Opt. {BeamSearch: bsize=10, hints=19, expected recall: 0.9, n: 2047
  == Begin Opt. {BeamSearch: bsize=10, hints=19 iteration: 1, expected recall: 0.9, n: 2047
    ** new best conf: (state={BeamSearch: bsize=7, hints=0, score=20.30562923666372, perf=StatsComparison(1.0, 1.0, 1.0, 1.1496245861053467e-5, 106.03125, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 2, n: 2047
    ** new best conf: (state={BeamSearch: bsize=8, hints=0, score=19.312552418227565, perf=StatsComparison(1.0, 1.0, 1.0, 1.3127923011779785e-5, 111.78125, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 6, n: 2047
    ** new best conf: (state={BeamSearch: bsize=10, hints=0, score=20.036326649229874, perf=StatsComparison(1.0, 1.0, 1.0, 1.274794340133667e-5, 107.53125, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 7, n: 2047
    ** new best conf: (state={BeamSearch: bsize=9, hints=0, score=19.462232243517473, perf=StatsComparison(1.0, 1.0, 1.0, 1.268833875656128e-5, 110.875, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 8, n: 2047
    ** new best conf: (state={BeamSearch: bsize=3, hints=0, score=23.02555480833894, perf=StatsComparison(0.9971590909090909, 0.9971590909090909, 0.9971590909090909, 9.037554264068604e-6, 92.9375, StatsKnn(3.709390088915825, 0.21645535889547318, 0.46813064627349377, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 9, n: 2047
    ** new best conf: (state={BeamSearch: bsize=3, hints=0, score=20.617849655585506, perf=StatsComparison(0.9971590909090909, 0.9971590909090909, 0.9971590909090909, 9.745359420776367e-6, 104.34375, StatsKnn(3.710079811513424, 0.21645535889547318, 0.4683134639635682, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 10, n: 2047
    ** new best conf: (state={BeamSearch: bsize=5, hints=0, score=19.281886687133685, perf=StatsComparison(1.0, 1.0, 1.0, 1.0117888450622559e-5, 111.96875, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 11, n: 2047
  == Iteration finished, current best: (state={BeamSearch: bsize=3, hints=0, score=23.02555480833894, perf=StatsComparison(0.9971590909090909, 0.9971590909090909, 0.9971590909090909, 9.037554264068604e-6, 92.9375, StatsKnn(3.709390088915825, 0.21645535889547318, 0.46813064627349377, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 4, n: 2047
  == Begin Opt. {BeamSearch: bsize=2, hints=0 iteration: 2, expected recall: 0.9, n: 2047
  == Iteration finished, current best: (state={BeamSearch: bsize=3, hints=0, score=23.02555480833894, perf=StatsComparison(0.9971590909090909, 0.9971590909090909, 0.9971590909090909, 9.037554264068604e-6, 92.9375, StatsKnn(3.709390088915825, 0.21645535889547318, 0.46813064627349377, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), #beam: 4, n: 2047
==== END Opt. Finished, best: (state={BeamSearch: bsize=3, hints=0, score=23.02555480833894, perf=StatsComparison(0.9971590909090909, 0.9971590909090909, 0.9971590909090909, 9.037554264068604e-6, 92.9375, StatsKnn(3.709390088915825, 0.21645535889547318, 0.46813064627349377, 10.0), 1.9937753677368164e-5, StatsKnn(3.7093411460518837, 0.21645535889547318, 0.4680817034095526, 10.0))  ), n: 2047
calling callback optimize_hints; n=4095
calling callback optimize_parameters; n=4095
==== BEGIN Opt. {BeamSearch: bsize=3, hints=21, expected recall: 0.9, n: 4095
  == Begin Opt. {BeamSearch: bsize=3, hints=21 iteration: 1, expected recall: 0.9, n: 4095
  == Iteration finished, current best: (state={BeamSearch: bsize=16, hints=0, score=43.78564206268959, perf=StatsComparison(1.0, 1.0, 1.0, 1.0482726558562248e-5, 95.70967741935483, StatsKnn(3.2399219197611653, 0.16624526042611368, 0.41568919391401354, 10.0), 4.122334141885081e-5, StatsKnn(3.2399219197611653, 0.16624526042611368, 0.41568919391401354, 10.0))  ), #beam: 4, n: 4095
==== END Opt. Finished, best: (state={BeamSearch: bsize=16, hints=0, score=43.78564206268959, perf=StatsComparison(1.0, 1.0, 1.0, 1.0482726558562248e-5, 95.70967741935483, StatsKnn(3.2399219197611653, 0.16624526042611368, 0.41568919391401354, 10.0), 4.122334141885081e-5, StatsKnn(3.2399219197611653, 0.16624526042611368, 0.41568919391401354, 10.0))  ), n: 4095
calling callback optimize_hints; n=8191
calling callback optimize_parameters; n=8191
==== BEGIN Opt. {BeamSearch: bsize=16, hints=23, expected recall: 0.9, n: 8191
  == Begin Opt. {BeamSearch: bsize=16, hints=23 iteration: 1, expected recall: 0.9, n: 8191
    ** new best conf: (state={BeamSearch: bsize=5, hints=0, score=56.816013628620105, perf=StatsComparison(0.9971590909090908, 0.9971590909090908, 0.9971590909090908, 1.7561018466949463e-5, 146.75, StatsKnn(2.3105986192822456, 0.13207409402821213, 0.2937600240111351, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 2, n: 8191
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=48.43250090481361, perf=StatsComparison(0.9971590909090908, 0.9971590909090908, 0.9971590909090908, 1.8998980522155762e-5, 172.6875, StatsKnn(2.3105986192822456, 0.13207409402821213, 0.2937600240111351, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 3, n: 8191
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=47.99874484489869, perf=StatsComparison(0.9943181818181819, 0.9943181818181819, 0.9943181818181819, 1.8440186977386475e-5, 174.28125, StatsKnn(2.315124362707138, 0.13207409402821213, 0.29538334161043167, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 4, n: 8191
    ** new best conf: (state={BeamSearch: bsize=6, hints=0, score=61.75846082522021, perf=StatsComparison(0.9971590909090908, 0.9971590909090908, 0.9971590909090908, 1.6532838344573975e-5, 134.8125, StatsKnn(2.3105986192822456, 0.13207409402821213, 0.2937600240111351, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 5, n: 8191
    ** new best conf: (state={BeamSearch: bsize=13, hints=0, score=48.6653937079469, perf=StatsComparison(1.0, 1.0, 1.0, 2.0444393157958984e-5, 171.84375, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 6, n: 8191
    ** new best conf: (state={BeamSearch: bsize=4, hints=0, score=52.505600314403615, perf=StatsComparison(0.9971590909090908, 0.9971590909090908, 0.9971590909090908, 1.5847384929656982e-5, 159.03125, StatsKnn(2.3105986192822456, 0.13207409402821213, 0.2937600240111351, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 7, n: 8191
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=48.23589836006488, perf=StatsComparison(0.9943181818181819, 0.9943181818181819, 0.9943181818181819, 1.703202724456787e-5, 173.40625, StatsKnn(2.315286912024021, 0.13207409402821213, 0.29502179473638535, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 8, n: 8191
    ** new best conf: (state={BeamSearch: bsize=2, hints=0, score=48.167896346949796, perf=StatsComparison(0.9943181818181819, 0.9943181818181819, 0.9943181818181819, 1.7344951629638672e-5, 173.65625, StatsKnn(2.318550854921341, 0.13207409402821213, 0.29538334161043167, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 9, n: 8191
    ** new best conf: (state={BeamSearch: bsize=12, hints=0, score=52.55625491738788, perf=StatsComparison(1.0, 1.0, 1.0, 2.0347535610198975e-5, 158.875, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 10, n: 8191
  == Iteration finished, current best: (state={BeamSearch: bsize=6, hints=0, score=61.75846082522021, perf=StatsComparison(0.9971590909090908, 0.9971590909090908, 0.9971590909090908, 1.6532838344573975e-5, 134.8125, StatsKnn(2.3105986192822456, 0.13207409402821213, 0.2937600240111351, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 4, n: 8191
  == Begin Opt. {BeamSearch: bsize=12, hints=0 iteration: 2, expected recall: 0.9, n: 8191
  == Iteration finished, current best: (state={BeamSearch: bsize=6, hints=0, score=61.75846082522021, perf=StatsComparison(0.9971590909090908, 0.9971590909090908, 0.9971590909090908, 1.6532838344573975e-5, 134.8125, StatsKnn(2.3105986192822456, 0.13207409402821213, 0.2937600240111351, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), #beam: 4, n: 8191
==== END Opt. Finished, best: (state={BeamSearch: bsize=6, hints=0, score=61.75846082522021, perf=StatsComparison(0.9971590909090908, 0.9971590909090908, 0.9971590909090908, 1.6532838344573975e-5, 134.8125, StatsKnn(2.3105986192822456, 0.13207409402821213, 0.2937600240111351, 10.0), 8.406490087509155e-5, StatsKnn(2.3105141520500183, 0.13207409402821213, 0.2936755567789078, 10.0))  ), n: 8191
added n=10000, neighborhood=14, {BeamSearch: bsize=6, hints=0, LogNeighborhood, 2021-07-01T00:05:35.765
KnnResult{Int32, Float32}(Int32[4272, 5664, 4742], Float32[0.46436483, 0.6274073, 0.8162391], 3, 0)
KnnResult{Int32, Float32}(Int32[1188, 9480, 4114], Float32[0.024345834, 0.14145628, 0.14444777], 3, 0)
KnnResult{Int32, Float32}(Int32[4845, 2037, 1175], Float32[0.07080072, 0.07350176, 0.1246301], 3, 0)
KnnResult{Int32, Float32}(Int32[9421, 7719, 5659], Float32[0.12732568, 0.1484435, 0.22651052], 3, 0)
KnnResult{Int32, Float32}(Int32[39, 1047, 7777], Float32[0.07404027, 0.08341181, 0.10041868], 3, 0)</pre><p>There are a several options for the construction of the index, from specifying the precise searching algorithm (<code>search_algo</code>) and the neighborhood strategy to be used on construction (<code>neighborhood_algo</code>). You can also specify here if the construction will be made in parallel and how this paralllelism will be performed (<code>firstblock</code>, <code>block</code>).</p><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SearchGraph</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SearchGraphOptions</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Local-search-algorithms"><a class="docs-heading-anchor" href="#Local-search-algorithms">Local search algorithms</a><a id="Local-search-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Local-search-algorithms" title="Permalink"></a></h2><p>Regarding the search search algorithm, there are two alternatives, based on local search heuristics.</p><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.BeamSearch" href="#SimilaritySearch.BeamSearch"><code>SimilaritySearch.BeamSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">BeamSearch(bsize::Integer=16, hints=Int32[], beam=KnnResult(bsize), vstate=VisitedVertices())</code></pre><p>BeamSearch is an iteratively improving local search algorithm that explores the graph using blocks of <code>bsize</code> elements and neighborhoods at the time. Multithreading applications must have copies of this object due to shared cache objects.</p><ul><li><code>hints</code>: An initial hint for the exploration (empty hints imply <code>bsize</code> random starting points).</li><li><code>bsize</code>: The size of the beam.</li><li><code>beam</code>: A cache object for reducing memory allocations</li><li><code>vstate</code>: A cache object for reducing memory allocations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/beamsearch.jl#LL7-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.IHCSearch" href="#SimilaritySearch.IHCSearch"><code>SimilaritySearch.IHCSearch</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">IHCSearch(hints::Vector; restarts=length(hints), localimprovements=false)
IHCSearch(restarts::Integer=20; hints=Int32[], localimprovements=false)
IHCSearch(hints, restarts, localimprovements, vstate)</code></pre><p>IHCSearch is an iterated hill climbing algorithma, a local search algorithm. It greedily navigates the search graph and restart the search <code>restarts</code> times. Multithreading applications must have copies of this object due to shared cache objects.</p><ul><li><code>restarts</code>: The number of restarts.</li><li><code>hints</code>: An initial hint for the exploration (if it is not empty, then superseeds the initial points of the random starting points).</li><li><code>localimprovements</code>: An experimental technique that if it is true it will achieve very high quality results, at cost of increasing searching time.</li><li><code>vstate</code>: A cache object for reducing memory allocations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/ihc.jl#LL8-L21">source</a></section></article><h2 id="Neighborhood-algorithms"><a class="docs-heading-anchor" href="#Neighborhood-algorithms">Neighborhood algorithms</a><a id="Neighborhood-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Neighborhood-algorithms" title="Permalink"></a></h2><p>Regarding neighborhood algorithms, the package defines the following ones:</p><p>Neighborhood algorithms</p><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.FixedNeighborhood" href="#SimilaritySearch.FixedNeighborhood"><code>SimilaritySearch.FixedNeighborhood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">FixedNeighborhood(k=8)</code></pre><p>New items are connected with a fixed number of neighbors</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/neighborhood/fixedneighborhood.jl#LL6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.LogNeighborhood" href="#SimilaritySearch.LogNeighborhood"><code>SimilaritySearch.LogNeighborhood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LogNeighborhood(b=2)</code></pre><p>New items are connected with the <span>$\log_b n$</span> items in the current graph (where <span>$n$</span> is the current number of vertices in the graph)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/neighborhood/logneighborhood.jl#LL6-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.LogSatNeighborhood" href="#SimilaritySearch.LogSatNeighborhood"><code>SimilaritySearch.LogSatNeighborhood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">LogSatNeighborhood(b=1.1)</code></pre><p>New items are connected with a half partitioning scheme based on the Spatial access tree (<strong>cite</strong>), <span>$\log_b n$</span> near items are considered for this procedure. The Log-Sat method will produce small neighborhood with a nice covering of the search space.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/neighborhood/logsatneighborhood.jl#LL6-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.SatNeighborhood" href="#SimilaritySearch.SatNeighborhood"><code>SimilaritySearch.SatNeighborhood</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">SatNeighborhood(k=32)</code></pre><p>New items are connected with a small set of items computed with a SAT like scheme (<strong>cite</strong>). It starts with <code>k</code> near items that are reduced to a small neighborhood due to the SAT partitioning stage.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/neighborhood/satneighborhood.jl#LL6-L11">source</a></section></article><h2 id="Incremental-construction-of-the-index"><a class="docs-heading-anchor" href="#Incremental-construction-of-the-index">Incremental construction of the index</a><a id="Incremental-construction-of-the-index-1"></a><a class="docs-heading-anchor-permalink" href="#Incremental-construction-of-the-index" title="Permalink"></a></h2><p>The index supports insertions; for instance, it can be fully constructed using insertions as follows:</p><pre><code class="language-julia">using SimilaritySearch

index = SearchGraph()

append!(index, [rand(Float32, 4) for i in 1:1000])

search(index, rand(Float32, 4), 3)</code></pre><pre class="documenter-example-output">KnnResult{Int32, Float32}(Int32[718, 313, 358], Float32[0.0064238105, 0.012094451, 0.024711695], 3, 0)</pre><p>Each insertion is performed by the <code>push!</code> function or a chunk of items with <code>append!</code>; the last function also allows parallel insertions.</p><article class="docstring"><header><a class="docstring-binding" id="Base.push!-Tuple{SearchGraph, Any}" href="#Base.push!-Tuple{SearchGraph, Any}"><code>Base.push!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">push!(index::SearchGraph, item)</code></pre><p>Appends <code>item</code> into the index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/graph.jl#LL187-L191">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.append!-Tuple{SearchGraph, Any}" href="#Base.append!-Tuple{SearchGraph, Any}"><code>Base.append!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">append!(index::SearchGraph, db; parallel=false, parallel_firstblock=30_000, parallel_block=10_000)</code></pre><p>Appends all items in db to the index. It can be made in parallel or sequentially. In case of a parallel appending, then <code>parallel_firstblock</code> indicates the minimum number of items before going parallel, and <code>parallel_block</code> sets the chunck size to append in parallel.</p><p>Note: Parallel construction doesn&#39;t trigger callbacks listed in `callback_list&#39;, they must be executed manually.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/graph.jl#LL64-L73">source</a></section></article><h3 id="Customizing-the-insertion-method"><a class="docs-heading-anchor" href="#Customizing-the-insertion-method">Customizing the insertion method</a><a id="Customizing-the-insertion-method-1"></a><a class="docs-heading-anchor-permalink" href="#Customizing-the-insertion-method" title="Permalink"></a></h3><p>In particular, the procedure of pushing items into the index is made calling <code>find_neighborhood</code> and <code>push_neighborhood</code>; these methods can be overriden or used in other wyas to customize the insertion of data and the construction of the index.</p><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.find_neighborhood" href="#SimilaritySearch.find_neighborhood"><code>SimilaritySearch.find_neighborhood</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">find_neighborhood(algo::FixedNeighborhood, index::SearchGraph, item)</code></pre><p>Finds a list of neighbors using the <code>FixedNeighborhood</code> criterion of item in the index</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/neighborhood/fixedneighborhood.jl#LL18-L22">source</a></section><section><div><pre><code class="nohighlight">find_neighborhood(index::SearchGraph{T}, item)</code></pre><p>Searches for <code>item</code> neighborhood in the index, i.e., if <code>item</code> were in the index whose items should be its neighbors (intenal function)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/graph.jl#LL137-L142">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.push_neighborhood!" href="#SimilaritySearch.push_neighborhood!"><code>SimilaritySearch.push_neighborhood!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">push_neighborhood!(index::SearchGraph, item, neighbors::AbstractVector{Int32}; apply_callbacks=true)</code></pre><p>Inserts the object <code>item</code> into the index, i.e., creates an edge from items listed in L and the vertex created for ìtem` (internal function)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/graph.jl#LL148-L153">source</a></section></article><h3 id="Optimizing-the-index&#39;s-performance"><a class="docs-heading-anchor" href="#Optimizing-the-index&#39;s-performance">Optimizing the index&#39;s performance</a><a id="Optimizing-the-index&#39;s-performance-1"></a><a class="docs-heading-anchor-permalink" href="#Optimizing-the-index&#39;s-performance" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="SimilaritySearch.optimize!" href="#SimilaritySearch.optimize!"><code>SimilaritySearch.optimize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">function optimize!(search_algo::LocalSearchAlgorithm,
                   index::SearchGraph{T},
                   recall::Float64,
                   perf::Performance;
                   bsize::Int=4,
                   tol::Float64=0.01,
                   probes::Int=0) where T</code></pre><p>Optimizes a local search index for an specific algorithm to get the desired performance. Note that optimizing for low-recall will yield to faster searches; the train queries are specified as part of the <code>perf</code> struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/sadit/SimilaritySearch.jl/blob/6cd616de4b948dccb2c815f10d7c8b9272663679/src/graph/opt.jl#LL6-L18">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../searching/">« Searching</a><a class="docs-footer-nextpage" href="../knnresult/">Knn results »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Thursday 1 July 2021 00:05">Thursday 1 July 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
